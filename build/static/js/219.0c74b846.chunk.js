"use strict";(self.webpackChunkrasilabs=self.webpackChunkrasilabs||[]).push([[219],{2219:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var r=i(5336),n=i(5043),s=i(3216),o=i(7949),a=i(3003),l=i(1707),c=i(579);const d=()=>{const{runsheetId:e,orderId:t}=(0,s.g)(),i=(0,s.Zp)(),d=(0,a.wA)(),[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),[g,y]=(0,n.useState)(null),[x,v]=(0,n.useState)(!1),m=(0,n.useRef)(null),b=(0,n.useRef)(null),j=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current&&(m.current.srcObject=e)}catch(e){console.error("Error accessing the camera: ",e)}};(0,n.useEffect)((()=>{j();const e=m.current;return()=>{if(e){const t=e.srcObject,i=null===t||void 0===t?void 0:t.getTracks();null===i||void 0===i||i.forEach((e=>e.stop()))}}}),[]);return(0,c.jsxs)("div",{style:{display:"flex",position:"absolute",top:0,left:0,right:0,bottom:0,justifyContent:"center",alignItems:"center",height:"100%",flexDirection:"column",backgroundColor:"#000716"},children:[!x&&(0,c.jsxs)("div",{style:{height:"88vh",width:"100%",backgroundColor:"#000716"},children:[(0,c.jsx)("video",{ref:m,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"100%",position:"absolute",left:0,top:0}}),(0,c.jsx)("canvas",{ref:b,style:{display:"none"}})]}),x&&(0,c.jsx)("div",{style:{width:"100%",height:"88vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#000716"},children:(0,c.jsx)("img",{src:g,alt:"Captured",style:{width:"80%",height:"auto"}})}),(0,c.jsxs)("div",{className:"flex jcc aic",style:{width:"100%",gap:20,flexDirection:"column",height:"24vh",position:"absolute",bottom:0,background:"#000716"},children:[(0,c.jsx)(r.A,{onClick:()=>{if(x)y(null),v(!1),f(!1),j();else{if(m.current&&b.current){const e=b.current.getContext("2d");b.current.width=m.current.videoWidth,b.current.height=m.current.videoHeight,e.drawImage(m.current,0,0,b.current.width,b.current.height);const t=b.current.toDataURL("image/jpeg");y(t),f(!0),v(!0)}h(!0),setTimeout((()=>{h(!1)}),2e3)}},variant:"inline-link",fullWidth:!0,children:(0,c.jsx)("span",{style:{color:"#EAD72F"},children:x?"RETAKE PHOTO":"TAKE A PHOTO"})}),(0,c.jsx)("div",{style:{display:"flex",margin:"0 auto",width:"70%"},children:(0,c.jsx)(r.A,{disabled:!p,fullWidth:!0,variant:"primary",onClick:async()=>{if(g&&p){const r=await fetch(g).then((e=>e.blob())),n=new File([r],"captured-photo.jpg",{type:"image/jpeg"});d((0,l.Q)(n)).then((r=>{if("fulfilled"===r.meta.requestStatus){const n=r.payload;i("/app/home/runsheet/".concat(e,"/customer-details/order/").concat(t,"/captured-verify/").concat(encodeURIComponent(n)))}else alert("Upload failed. Please try again.")}))}else alert("No photo captured yet.")},children:"Verified"})})]}),u&&(0,c.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,c.jsxs)("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",textAlign:"center",width:"40%",maxWidth:"400px"},children:[(0,c.jsx)(o.A,{name:"status-positive",size:"big",variant:"success"}),(0,c.jsx)("h3",{style:{color:"#28a745"},children:"Photo Captured"})]})})]})}}}]);
//# sourceMappingURL=219.0c74b846.chunk.js.map